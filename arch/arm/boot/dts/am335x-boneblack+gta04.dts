/*
 * Copyright (C) 2014 H. Nikolaus Schaller <hns@goldelico.com>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 */

#include "am335x-boneblack.dts"
#include <dt-bindings/input/input.h>

/ {

	/* overwrite device model */
	model = "BeagleBoneBlack / GTA04";

/*
 * we assume a Chipsee BBB-EXP43 with 4.3 inch panel, resistive touch and some LEDs and Buttons
 * http://www.chipsee.com/index.php/evm/beagleboard/cs-bbb-exp43.html
 */

/*
user LED gpio1_28
buttons: gpio1_16, 1_17, 1_18, 1_19, 3_16  => up/down/left/right/enter
lcd: 18 bit parallel
enable: GPIO3_19
backlight: EHRPWM1A
touch: internal to am335x
*/

	gpio-leds {

		compatible = "gpio-leds";

		pinctrl-names = "default";
//		pinctrl-0 = <&led_pins>;

		led@user {
			label = "bbb-exp43::user";
			gpios = <&gpio1 28 GPIO_ACTIVE_HIGH>;
			linux,default-trigger = "heartbeat";
			default-state = "on";
		};
	};

	gpio-keys {
		compatible = "gpio-keys";

		pinctrl-names = "default";
//		pinctrl-0 = <&button_pins>;

		up-button {
			label = "up";
			linux,code = <KEY_UP>;
			gpios = <&gpio1 16 GPIO_ACTIVE_LOW>;
			gpio-key,wakeup;
		};

		down-button {
			label = "down";
			linux,code = <KEY_DOWN>;
			gpios = <&gpio1 17 GPIO_ACTIVE_LOW>;
			gpio-key,wakeup;
		};

		left-button {
			label = "left";
			linux,code = <KEY_LEFT>;
			gpios = <&gpio1 18 GPIO_ACTIVE_LOW>;
			gpio-key,wakeup;
		};

		right-button {
			label = "right";
			linux,code = <KEY_RIGHT>;
			gpios = <&gpio1 19 GPIO_ACTIVE_LOW>;
			gpio-key,wakeup;
		};

		pageup-button {
			label = "enter";
			linux,code = <KEY_ENTER>;
			gpios = <&gpio3 16 GPIO_ACTIVE_LOW>;
			gpio-key,wakeup;
		};

	};

	backlight {
		compatible = "pwm-backlight";
		pwms = <&ehrpwm1 0 50000 0>;
		brightness-levels = <0 51 53 56 62 75 101 152 255>;
		default-brightness-level = <8>;
	};

	panel {
		compatible = "ti,tilcdc,panel";
		status = "okay";
		pinctrl-names = "default";
//		pinctrl-0 = <&lcd_pins_s0>;
		panel-info {
			ac-bias           = <255>;
			ac-bias-intrpt    = <0>;
			dma-burst-sz      = <16>;
			bpp               = <32>;
			fdd               = <0x80>;
			sync-edge         = <0>;
			sync-ctrl         = <1>;
			raster-order      = <0>;
			fifo-th           = <0>;
		};

		display-timings {
			800x480p62 {
				clock-frequency = <30000000>;
				hactive = <800>;
				vactive = <480>;
				hfront-porch = <39>;
				hback-porch = <39>;
				hsync-len = <47>;
				vback-porch = <29>;
				vfront-porch = <13>;
				vsync-len = <2>;
				hsync-active = <1>;
				vsync-active = <1>;
			};
		};
	};

};

&lcdc {
	status = "okay";
};

&tscadc {
	status = "okay";

	tsc {
		ti,wires = <4>;
		ti,x-plate-resistance = <600>;
		ti,coordinate-readouts = <5>;
		ti,wire-config = <0x00 0x11 0x22 0x33>;
	};

	adc {
		ti,adc-channels = <4 5 6 7>;
	};
};
